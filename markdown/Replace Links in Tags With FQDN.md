title: Replace Links in Tags With FQDN

## Flags

> Flags: `(?i-Ums)`

> * -U: Greedy
> * -m: Do not treat target as one line
> * -s: Dot does not match newline
> * i: Case insensitive

## Regular Expression Search

```ruby
/(?i-Ums)(<(?:img|a)\s+[^>=]*=\s*((")|(')))(?!http://|javascript:|feed:|(?(3)[^"]|[^'])*www.mactechnologies.com)/?((?(3)[^"]|[^'])*?\2[^>]*>)/
```

## Replace

```ruby
"$1http://www.mactechnologies.com/$5$6\"
```

---

## Test string:

```text
[Below is a section of the source of an actual web site. Some of the tags do not lead off with a domain name. This pattern identifies these "img" and "a" tags and inserts the domain name into the link. Note that any links that start with "http://" or "javascript:" or "feed:" are ignored, as are any links that already contain the domain name.]

<img src="/images/mtc.png" alt="MacTechnologies Consulting" id="mtc" width="700" height="53" /><h3 class="subscribe">Subscribe to our mailing list:</h3></div><div id="menu"><ul><li><a href="/index.php?page=home" title="Refresh this page" class="highlighted"><span class="highlighted">Home</span></a></li><li><a href="/index.php?page=contact" title="Go to Contact" class="inactive"><span class="inactive">Contact</span></a></li><li><a href="/index.php?page=downloads" title="Go to Downloads" class="inactive"><span class="inactive">Downloads</span></a></li><li><a href="/index.php?page=register" title="Go to Register" class="inactive"><span class="inactive">Register</span></a></li><li><a href="/index.php?page=support" title="Go to Support" class="inactive"><span class="inactive">Support</span></a></li><li><a href="/wordpress/index.php" title="Go to Blog" class="inactive"><span class="inactive">Blog</span></a></li></ul><form name="subscribe_form" class="subscribe" id="subscribe_form" method="post" action="http://groups.yahoo.com/subscribe/MacTechnologies_Consulting" target="_blank"> <input type="text" name="user" value="Your E-mail" onfocus="myFocus(this);" onblur="myBlur(this);" onchange="myChange(this);" /> <input class="button" type="submit" value="Join!" /></form></div><div id="container2"><div id="content"><p class="noindent_border"><b class="emphasis">MacTechnologies Consulting</b> has been providing Macintosh help to individuals and businesses in the tri-state area since 1993, assisting with everything from setup to installation to custom <a href="http://www.apple.com/" target="_blank" title="Visit Apple's web site"> <img src="/images/leopard.png" alt="Macintosh" width="70" align="left" hspace="15" vspace="15" /></a>application development. We want to form long-term relationships and become a resource for everything from simple questions to providing a calm voice during late-night emergencies.<br /><br />We pride ourselves on our rapid response and ability to give clear, concise answers to your most complicated questions. Call us today at (212)&nbsp;201-1465.<br /></p><h2 class="rsslink">Recently Posted:</h2><a href="feed://www.mactechnologies.com/wordpress/?feed=rss2" title="View the RSS feed for blog entries"><img src="./images/rss.gif" alt="rss" class="bodyrss" /></a><div id='blogpost-1' class='firstblogpost'> <b class="emphasis"><a href="http://www.mactechnologies.com/wordpress/?p=131" rel="bookmark" title="Permanent Link to Managing a Blackberry on your Mac">Managing a Blackberry on your Mac</a></b><br /><i>posted on October 3, 2009</i><br /><br /><p>Let me start by saying this: If you are in the market for a new mobile phone and ask me which will best suit your needs, my answer will be an iPhone. Every day, for everybody, the answer is &ldquo;iPhone&rdquo;.<br /><br />But I understand that some of you need to use, or even prefer, a Blackberry, and your main concern is how to sync and manage that device on your Mac. Until now, the solution has been software called <a href=&ldquo;http://www.markspace.com/products/blackberry/blackberry-sync-mac-software.html&rdquo; target=&ldquo;_blank&rdquo;>The Missing Sync for Blackberry</a> from <a href=&ldquo;http://www.markspace.com/&ldquo; target=&ldquo;_blank&rdquo;>Mark/Space</a>, and while I still recommend that (especially over the PocketMac software that came with the Blackberry), it costs $40.<br /><br />Now, Blackberry has released their free <a href=&ldquo;http://na.blackberry.com/eng/services/desktop/desktop_mac.jsp&rdquo; target=&ldquo;_blank&rdquo;>Blackberry Desktop Software</a> that is supposed to let Mac users synchronize with their Address Book and iCal, and backup their Blackberries. It will also let you manage your Blackberry applications.<br /></p><div id='bloglink-1' class='firstbloglink'><p>(<a href="http://www.mactechnologies.com/wordpress/?p=131" rel="bookmark">read full post</a>)</p></div></div><div id='blogpost-2' class='blogpost'> <b class="emphasis"><a href="http://www.mactechnologies.com/wordpress/?p=113" rel="bookmark" title="Permanent Link to Viva vacation">Viva vacation</a></b><br /><i>posted on September 3, 2009</i><br /><br /><p>I will be away on vacation starting Saturday, September 5, and returning on Monday, September 14.<br /><br />In the past, I&#8217;ve provided completely accurate, if somewhat vague, details of my vacation plans, but these are serious times that demand serious accounts, so here is our itinerary: We will be vanishing.<br /></p><div id='bloglink-2' class='bloglink'><p>(<a href="http://www.mactechnologies.com/wordpress/?p=113" rel="bookmark">read full post</a>)</p></div></div><div id='blogpost-last' class='lastblogpost'> <b class="emphasis"><a href="http://www.mactechnologies.com/wordpress/?p=103" rel="bookmark" title="Permanent Link to Snow Leopard is here">Snow Leopard is here</a></b><br /><i>posted on September 2, 2009</i><br /><br /><p>Apple last week released Mac OS X 10.6 (Snow Leopard). Although it contains a few new interface features (welcome back, Put Away!), it is mostly under-the-hood refinements designed to make the OS faster and more secure.<br /></p><div id='bloglink-last' class='lastbloglink'><p>(<a href="http://www.mactechnologies.com/wordpress/?p=103" rel="bookmark">read full post</a>)</p></div></div></div><div id="sidebar"><form method="get" id="searchform" action="/wordpress/"><div><input type="text" name="s" id="s" value="Search Blogs" onfocus="myFocus(this);" onblur="myBlur(this);" onchange="myChange(this);" /> <input type="submit" id="searchsubmit" value="Search" class="button" /></div></form><p><b class="sidebartitle">WHAT OUR CLIENTS<br />HAVE TO SAY:</b></p><p class="test">&ldquo;As the owner operator of a small business for over 10-years, I needed to find an IT consultant that could: handle a range of challenges without having to refer me to an array of other vendors; assist us/trouble shoot over the phone or via remote connection and ask the right questions so that they could provide guidance on cost-efficient equipment solutions. MacTechnologies provided that and more.&rdquo;<br /><span class="author">Paul Diamond</span><br /><span class="company">Health Education Alliance, Inc.</span></p><p class="test">&ldquo;We&#8217;ve been working with Kem for more then 15 years and could not find a more reliable, knowledgeable or personable person to assist us in our business and personal computer needs. We love him!!!&rdquo;<br /><span class="author">Arthur Ashman</span><br /><span class="company">Bioplant</span></p><p class="test">&ldquo;The world is 24/7 and so is my business. MacTechnologies has made it viable and possible to run 3 web sites, 3 Macs, and 2 businesses with no worries and an extremely high level of confidence.&rdquo;<br /><span class="author">Bob Blank</span><br /><span class="company">Blank Productions</span></p></div><div id="certifications"> <a href="http://www.apple.com/" target="_blank"><img src="/images/applecertred.jpg" alt="Apple Help Desk Specialist" width="125" align="left" vspace="15" height="56" /></a> <a href="http://www.filemaker.com/" target="_blank"><img src="/images/filemaker.jpg" alt="FileMaker Business Alliance" width="125" align="right" vspace="15" height="36" /></a></div></div><div id="footer"><p><a href="feed://www.mactechnologies.com/wordpress/?feed=rss2" class="rss" title="View the RSS feed for blog entries">Entries RSS</a> <a href="feed://www.mactechnologies.com/wordpress/?feed=comments-rss2" class="rss" title="View the RSS feed for comments to blog entries">Comments RSS</a> <a href="/wordpress/wp-login.php" class="loginout">Login</a><br /></p></div><p class="tm">Copyright &copy; 2009 MacTechnologies Consulting. Apple, Mac and Macintosh are registered trademarks of Apple Inc.</p></div></body></html>
```


